{"ast":null,"code":"var _jsxFileName = \"/Users/hieu/Documents/DoAnCuoiKi/src/WEB_NC/webapp/src/modules/content/ContentDetail.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { ASSETS_URL } from \"../../shared/constants/constants\";\nimport { Divider } from \"antd\";\nimport { StudyProcessService } from \"../study-process/StudyProcessService\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst {\n  Player\n} = require(\"video-react\");\n\nexport function ContentDetail(props) {\n  _s();\n\n  const {\n    studyProcess\n  } = props;\n  const [play, setPlay] = useState(false);\n  const playerRef = useRef();\n  const lastStateRef = useRef();\n  const contentId = props.content.id;\n  const courseId = props.courseId;\n  useEffect(() => {\n    let unsubscribe;\n\n    if (play) {\n      console.log(playerRef);\n      unsubscribe = playerRef.current.subscribeToStateChange(state => {\n        lastStateRef.current = state;\n\n        if (state.ended && !(studyProcess && studyProcess.done)) {\n          StudyProcessService.update(courseId, contentId, Math.floor(state.duration));\n        }\n      });\n    }\n\n    return () => {\n      if (play) {\n        if (lastStateRef.current && lastStateRef.current.currentTime > 0) {\n          StudyProcessService.update(courseId, contentId, Math.floor(lastStateRef.current.currentTime));\n        }\n\n        unsubscribe();\n      }\n    };\n  }, [play, courseId, contentId, studyProcess]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: props.content.description\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), play ? /*#__PURE__*/_jsxDEV(Player, {\n      autoPlay: true,\n      startTime: (studyProcess === null || studyProcess === void 0 ? void 0 : studyProcess.duration) || 0,\n      ref: ref => playerRef.current = ref,\n      src: `${ASSETS_URL}/${props.content.videoPath}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-2\",\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"cursor-pointer text-blue-400 hover:underline\",\n        onClick: () => setPlay(true),\n        children: \"\\u2022 View content video\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ContentDetail, \"Uaa2Q50XBLXD1zfz2JopcSqpdZo=\");\n\n_c = ContentDetail;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContentDetail\");","map":{"version":3,"sources":["/Users/hieu/Documents/DoAnCuoiKi/src/WEB_NC/webapp/src/modules/content/ContentDetail.tsx"],"names":["React","useEffect","useRef","useState","ASSETS_URL","Divider","StudyProcessService","Player","require","ContentDetail","props","studyProcess","play","setPlay","playerRef","lastStateRef","contentId","content","id","courseId","unsubscribe","console","log","current","subscribeToStateChange","state","ended","done","update","Math","floor","duration","currentTime","__html","description","ref","videoPath"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,QAAmD,OAAnD;AAEA,SAASC,UAAT,QAA2B,kCAA3B;AACA,SAASC,OAAT,QAAwB,MAAxB;AACA,SAASC,mBAAT,QAAoC,sCAApC;;;AAEA,MAAM;AAAEC,EAAAA;AAAF,IAAaC,OAAO,CAAC,aAAD,CAA1B;;AAQA,OAAO,SAASC,aAAT,CAAuBC,KAAvB,EAAmD;AAAA;;AACxD,QAAM;AAAEC,IAAAA;AAAF,MAAmBD,KAAzB;AACA,QAAM,CAACE,IAAD,EAAOC,OAAP,IAAkBV,QAAQ,CAAC,KAAD,CAAhC;AACA,QAAMW,SAAS,GAAGZ,MAAM,EAAxB;AACA,QAAMa,YAAY,GAAGb,MAAM,EAA3B;AACA,QAAMc,SAAS,GAAGN,KAAK,CAACO,OAAN,CAAcC,EAAhC;AACA,QAAMC,QAAQ,GAAGT,KAAK,CAACS,QAAvB;AAEAlB,EAAAA,SAAS,CAAC,MAAM;AACd,QAAImB,WAAJ;;AACA,QAAIR,IAAJ,EAAU;AACRS,MAAAA,OAAO,CAACC,GAAR,CAAYR,SAAZ;AACAM,MAAAA,WAAW,GAAGN,SAAS,CAACS,OAAV,CAAkBC,sBAAlB,CAA0CC,KAAD,IAAgB;AACrEV,QAAAA,YAAY,CAACQ,OAAb,GAAuBE,KAAvB;;AACA,YAAIA,KAAK,CAACC,KAAN,IAAe,EAAEf,YAAY,IAAIA,YAAY,CAACgB,IAA/B,CAAnB,EAAyD;AACvDrB,UAAAA,mBAAmB,CAACsB,MAApB,CACET,QADF,EAEEH,SAFF,EAGEa,IAAI,CAACC,KAAL,CAAWL,KAAK,CAACM,QAAjB,CAHF;AAKD;AACF,OATa,CAAd;AAUD;;AACD,WAAO,MAAM;AACX,UAAInB,IAAJ,EAAU;AACR,YAAIG,YAAY,CAACQ,OAAb,IAAwBR,YAAY,CAACQ,OAAb,CAAqBS,WAArB,GAAmC,CAA/D,EAAkE;AAChE1B,UAAAA,mBAAmB,CAACsB,MAApB,CACET,QADF,EAEEH,SAFF,EAGEa,IAAI,CAACC,KAAL,CAAWf,YAAY,CAACQ,OAAb,CAAqBS,WAAhC,CAHF;AAKD;;AACDZ,QAAAA,WAAW;AACZ;AACF,KAXD;AAYD,GA3BQ,EA2BN,CAACR,IAAD,EAAOO,QAAP,EAAiBH,SAAjB,EAA4BL,YAA5B,CA3BM,CAAT;AA6BA,sBACE;AAAA,4BACE;AACE,MAAA,uBAAuB,EAAE;AAAEsB,QAAAA,MAAM,EAAEvB,KAAK,CAACO,OAAN,CAAciB;AAAxB;AAD3B;AAAA;AAAA;AAAA;AAAA,YADF,eAIE,QAAC,OAAD;AAAA;AAAA;AAAA;AAAA,YAJF,EAKGtB,IAAI,gBACH,QAAC,MAAD;AACE,MAAA,QAAQ,MADV;AAEE,MAAA,SAAS,EAAE,CAAAD,YAAY,SAAZ,IAAAA,YAAY,WAAZ,YAAAA,YAAY,CAAEoB,QAAd,KAA0B,CAFvC;AAGE,MAAA,GAAG,EAAGI,GAAD,IAAerB,SAAS,CAACS,OAAV,GAAoBY,GAH1C;AAIE,MAAA,GAAG,EAAG,GAAE/B,UAAW,IAAGM,KAAK,CAACO,OAAN,CAAcmB,SAAU;AAJhD;AAAA;AAAA;AAAA;AAAA,YADG,gBAQH;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA,6BACE;AACE,QAAA,SAAS,EAAC,8CADZ;AAEE,QAAA,OAAO,EAAE,MAAMvB,OAAO,CAAC,IAAD,CAFxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAbJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAyBD;;GA9DeJ,a;;KAAAA,a","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { IContent } from \"../../shared/entities/IContent\";\nimport { ASSETS_URL } from \"../../shared/constants/constants\";\nimport { Divider } from \"antd\";\nimport { StudyProcessService } from \"../study-process/StudyProcessService\";\nimport { IStudyProcess } from \"../../shared/entities/IStudyProcess\";\nconst { Player } = require(\"video-react\");\n\ninterface IContentDetailProps {\n  courseId: number;\n  content: IContent;\n  studyProcess: IStudyProcess\n}\n\nexport function ContentDetail(props: IContentDetailProps) {\n  const { studyProcess } = props;\n  const [play, setPlay] = useState(false);\n  const playerRef = useRef<any>();\n  const lastStateRef = useRef<any>();\n  const contentId = props.content.id;\n  const courseId = props.courseId;\n\n  useEffect(() => {\n    let unsubscribe: any;\n    if (play) {\n      console.log(playerRef);\n      unsubscribe = playerRef.current.subscribeToStateChange((state: any) => {\n        lastStateRef.current = state;\n        if (state.ended && !(studyProcess && studyProcess.done)) {\n          StudyProcessService.update(\n            courseId,\n            contentId,\n            Math.floor(state.duration)\n          );\n        }\n      });\n    }\n    return () => {\n      if (play) {\n        if (lastStateRef.current && lastStateRef.current.currentTime > 0) {\n          StudyProcessService.update(\n            courseId,\n            contentId,\n            Math.floor(lastStateRef.current.currentTime)\n          );\n        }\n        unsubscribe();\n      }\n    };\n  }, [play, courseId, contentId, studyProcess]);\n\n  return (\n    <div>\n      <div\n        dangerouslySetInnerHTML={{ __html: props.content.description }}\n      ></div>\n      <Divider />\n      {play ? (\n        <Player\n          autoPlay\n          startTime={studyProcess?.duration || 0}\n          ref={(ref: any) => (playerRef.current = ref)}\n          src={`${ASSETS_URL}/${props.content.videoPath}`}\n        />\n      ) : (\n        <div className=\"mt-2\">\n          <span\n            className=\"cursor-pointer text-blue-400 hover:underline\"\n            onClick={() => setPlay(true)}\n          >\n            &bull; View content video\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}